<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Spotify DataViz</title>
    <link rel="stylesheet" href="fontawesome-5.5/css/all.min.css" />
    <link rel="stylesheet" href="slick/slick.css">
    <link rel="stylesheet" href="slick/slick-theme.css">
    <link rel="stylesheet" href="magnific-popup/magnific-popup.css">
    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <link rel="stylesheet" href="css/tooplate-infinite-loop.css" />
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> <!-- jQuery, si nécessaire -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
    <script src="D3.js"></script>
<!--
Tooplate 2117 Infinite Loop
https://www.tooplate.com/view/2117-infinite-loop
-->

  </head>
  <body>    
    <!-- Hero section -->
    <section id="infinite" class="text-white tm-font-big tm-parallax">
      <!-- Navigation -->
      <nav class="navbar navbar-expand-md tm-navbar" id="tmNav">              
        <div class="container">   
          <div class="tm-next">
              <a href="#infinite" class="navbar-brand">Spotify DataViz</a>
          </div>             
            
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <i class="fas fa-bars navbar-toggler-icon"></i>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ml-auto">
              <li class="nav-item">
                  <a class="nav-link tm-nav-link" href="#Accueil">Accueil</a>
              </li>
              <li class="nav-item">
                  <a class="nav-link tm-nav-link" href="#Visualisations">Visualisations</a>
              </li>
              <li class="nav-item">
                <a class="nav-link tm-nav-link" href="#DataSource">Source de données</a>
              </li>
              <li class="nav-item">
                  <a class="nav-link tm-nav-link" href="#Technologies">Technologies</a>
              </li>                    
            </ul>
          </div>        
        </div>
        <div class="dropdown" style="text-align: center;">
          <button class="btn btn-secondary dropdown-toggle" type="button" id="userDropdown" data-bs-toggle="dropdown" 
            aria-expanded="false">
            <span id="selectedUserName">Choisir un utilisateur</span>
          </button>
          <ul class="dropdown-menu" id="userDropdownMenu">

          </ul>
        </div>
      </nav>
      
      <div class="text-center tm-hero-text-container">
        <div class="tm-hero-text-container-inner">
            <h2 class="tm-hero-title">Harmonie en Vue</h2>
            <h3 class="tm-hero-subtitle">
              Visualisez, Vibrez, Redécouvrez 
              <br>votre musique.
            </h3>
        </div>        
      </div>

      <div class="tm-next tm-intro-next">
        <a href="#ecosysteme" class="text-center tm-down-arrow-link">
          <i class="fas fa-2x fa-arrow-down tm-down-arrow"></i>
        </a>
      </div>      
    </section>

    <section id="ecosysteme" class="tm-section-pad-top">
      <center><h2>L'Écosystème de Vos Écoutes</h2></center>
          <center><h3>Les points d'écoute les plus intenses révèlent vos artistes phares.</h3></center>
      <div id="fdGraphContainer">
        <div id="fdGraph"></div>
      </div>    
        <div class="container">
          <div id="tooltip" class="tooltip" style="opacity: 0; position: absolute; background: #fff; border: 1px solid #ccc; padding: 5px; pointer-events: none;"></div>
          <div class="story-step">
              <div class="story-text">
                  <h2>Vos Icônes Musicales de l’Année !</h2>
                  <p>Ils ont été la bande-son de votre vie cette année ! Explorez les artistes qui ont dominé vos playlists, avec des tailles qui reflètent leur impact. Chaque rectangle est une ode à ceux qui ont rythmé vos journées et vos nuits. Passez la souris pour découvrir qui a vraiment marqué votre année musicale !</p>    
              </div>
              <div class="chart" id="treemap-container"></div>
          </div>
          <div class="story-step">
              <div class="story-text">
                  <h2>Les Minutes Qui Ont Rythmé Vos Mois !</h2>
                  <p>Plongez dans le rythme de votre année ! Découvrez comment vos écoutes musicales ont marqué chaque mois, minute par minute. Les couleurs racontent une histoire : vos moments calmes, vos pics d'énergie, et les périodes où la musique était votre meilleure alliée. Faites défiler et retrouvez vos souvenirs, un mois à la fois.</p>
              </div>
              <div class="chart" id="listeningTimelineChart"></div>
          </div>
  
          <div class="story-step">
              <div class="story-text">
                  <h2>Ton cycle quotidien d'écoute</h2>
                  <p>La <span class="spotify-highlight"> musique </span> rythme tes <span class="spotify-highlight"> journées </span> : voici comment elle accompagne ton matin, ton après-midi, et tes soirées.</p>
              </div>
              <div class="chart" id="ecoutesChart"></div>         
          </div>
  
          <div class="story-step">
              <div class="story-text">
                  <h2>Le genre musical qui te définit</h2>
                  <p>Chaque <span class="spotify-highlight"> note </span> raconte une part de toi : découvre comment tes <span class="spotify-highlight"> préférences musicales </span> se répartissent et définissent ton univers sonore.</p>
  
              </div>
              <div class="chart" id="pieChart"></div>
          </div>
          <div class="story-step">
              <div class="story-text">
                  <h2>Ton équilibre entre podcasts et musique</h2>
                  <p>Plongé entre les rythmes de la <span class="spotify-highlight">musique</span> et les récits captivants des <span class="spotify-highlight">podcasts</span>, découvre comment tu partages ton temps entre ces deux univers sonores.</p>
                
              </div>
              <div class="chart" id="podcastMusicChart">
                  
              </div>
          </div>
          <div class="story-step">
            <div class="story-text">
                <h2>Top 20 des Playlists les Plus Remplies : Un Océan de Musique</h2>
                <p>Découvrez le classement de vos 20 playlists les plus remplies de chansons ! Cette visualisation met en avant vos collections musicales les plus vastes, selon le nombre de morceaux qu'elles contiennent. Grâce à un filtre interactif, vous pouvez également explorer comment le nombre de chansons dans chaque playlist évolue mois après mois, révélant les tendances et les dynamiques musicales au fil de l'année.</p>
                <select id="month-filter">
                  <option value="2024-01">Janvier 2024</option>
                  <option value="2024-02">Février 2024</option>
                  <option value="2024-03">Mars 2024</option>
                  <option value="2024-04">Avril 2024</option>
                  <option value="2024-05">Mai 2024</option>
                  <option value="2024-06">Juin 2024</option>
                  <option value="2024-07">Juillet 2024</option>
                  <option value="2024-08">Août 2024</option>
                  <option value="2024-09">Septembre 2024</option>
                  <option value="2024-10">Octobre 2024</option>
                  <option value="2024-11">Novembre 2024</option>
                  <option value="2024-12" selected>Décembre 2024</option>
              </select>
              </div>
            <div class="chart" id="playlist-chart"></div>
        </div>
      </div>

      
</div>
      
    </section>
    
    <section id="testimonials" class="tm-section-pad-top tm-parallax-2">      
      <div class="container tm-testimonials-content">
        <div class="row">
          <div class="col-lg-12 tm-content-box">
            <h2 class="text-white text-center mb-4 tm-section-title">Source des données</h2>
            <p>
              Pour ce projet, les données utilisées proviennent des historiques Spotify de plusieurs utilisateurs. Afin de garantir une source légitime et fiable, nous avons contacté des amis et leur avons expliqué le but du projet. Ils ont généreusement accepté de partager leurs données personnelles Spotify avec nous. Ces données contiennent des informations telles que les chansons écoutées, les artistes favoris, les genres musicaux préférés, et les horaires d'écoute.
              Les utilisateurs ont téléchargé leurs données personnelles directement depuis Spotify en utilisant la fonctionnalité de demande de données personnelles disponible dans les paramètres de confidentialité de la plateforme.
              </p>
            <div class="mx-auto tm-gallery-container tm-gallery-container-2">
              <div class="tm-testimonials-carousel">
                <figure class="tm-testimonial-item">
                  <blockquote><h3>Processus de collecte</h3></blockquote> 
                  <p>Une fois les utilisateurs ayant accepté de participer : chaque utilisateur a accédé à la section de confidentialité de leur compte Spotify pour demander une copie de leurs données personnelles pour l'année 2024. Ce processus a pris 5 jours avant que Spotify génère et envoie les fichiers.
                    Les fichiers reçus, en format JSON , ont été transmis avec leur consentement explicite à l’équipe du projet.
                  </p>
                  </figure>

                <figure class="tm-testimonial-item">
                  <blockquote><h3>Nettoyage des données</h3></blockquote>
                  <p>
                  Le processus charge et organise les données utilisateur en récupérant, via un fichier d'index, les fichiers JSON associés à chaque utilisateur (historique, playlists, etc.) depuis un dépôt GitHub, puis les structure pour une utilisation efficace.    
                  </p>
                </figure>

                <figure class="tm-testimonial-item">
                  <blockquote><h3>Transformation en visualisation</h3></blockquote>
                  <p>Les données nettoyées ont été transformées en graphiques pour mettre en évidence les tendances et comportements d’écoute. Ces visualisations permettent d'explorer les préférences musicales et les habitudes d’écoute de manière claire et esthétique.</p>
                </figure>

              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="tm-bg-overlay"></div>
    </section>
    
    <section id="gallery" class="tm-section-pad-top">
      <div class="container tm-container-gallery">
        <div class="row">
          <div class="text-center col-12">
              <h2 class="tm-text-primary tm-section-title mb-4">Outils et Technologies</h2>
              <p class="mx-auto tm-section-desc">
                <b>HTML (HyperText Markup Language)</b> est le langage standard pour structurer le contenu des pages web. Il permet de définir la structure de base d'un site web en utilisant des balises pour les titres, paragraphes, liens, images, et autres éléments.
                <br> <b>CSS (Cascading Style Sheets)</b> est une technologie utilisée pour définir le style et la présentation des documents HTML. Elle permet de contrôler les couleurs, polices, dispositions, animations, et bien plus, pour rendre les pages web esthétiques et adaptatives.
                <br> <b>Bootstrap</b> : est une bibliothèque front-end open-source qui facilite le développement de sites web réactifs. Il offre des composants préconçus comme des grilles, boutons, formulaires, et bien plus, pour accélérer la création d'interfaces modernes.
                <br> <b>D3 js (Data-Driven Documents)</b> est une bibliothèque JavaScript utilisée pour produire des visualisations de données interactives et dynamiques basées sur le web. Elle permet de manipuler directement les éléments SVG, HTML, ou CSS en fonction des données.
                <br> Pour une gestion optimale de notre projet, nous avons utilisé <b>GitHub</b>. Cette plateforme a facilité la collaboration entre les membres de l'équipe en permettant une gestion efficace des versions.
              </p>
          </div>            
        </div>
      </div>
    </section>

    <!-- Contact -->
    <section id="contact" class="tm-section-pad-top tm-parallax-2">

      	<footer class="text-center small tm-footer">
          <h3 class="mb-0"> Ce travail est réalisé par : LIROULET Inès, RIDOUAN Aafaf et YAKOUBI Oumayma</h3>
        </footer>

    </section>

    
    <script src="js/jquery-1.9.1.min.js"></script>     
    <script src="slick/slick.min.js"></script>
    <script src="magnific-popup/jquery.magnific-popup.min.js"></script>
    <script src="js/easing.min.js"></script>
    <script src="js/jquery.singlePageNav.min.js"></script>     
    <script src="js/bootstrap.min.js"></script> 
    <script>

      function getOffSet(){
        var _offset = 450;
        var windowHeight = window.innerHeight;

        if(windowHeight > 500) {
          _offset = 400;
        } 
        if(windowHeight > 680) {
          _offset = 300
        }
        if(windowHeight > 830) {
          _offset = 210;
        }

        return _offset;
      }

      function setParallaxPosition($doc, multiplier, $object){
        var offset = getOffSet();
        var from_top = $doc.scrollTop(),
          bg_css = 'center ' +(multiplier * from_top - offset) + 'px';
        $object.css({"background-position" : bg_css });
      }

      // Parallax function
      // Adapted based on https://codepen.io/roborich/pen/wpAsm        
      var background_image_parallax = function($object, multiplier, forceSet){
        multiplier = typeof multiplier !== 'undefined' ? multiplier : 0.5;
        multiplier = 1 - multiplier;
        var $doc = $(document);
        // $object.css({"background-attatchment" : "fixed"});

        if(forceSet) {
          setParallaxPosition($doc, multiplier, $object);
        } else {
          $(window).scroll(function(){          
            setParallaxPosition($doc, multiplier, $object);
          });
        }
      };

      var background_image_parallax_2 = function($object, multiplier){
        multiplier = typeof multiplier !== 'undefined' ? multiplier : 0.5;
        multiplier = 1 - multiplier;
        var $doc = $(document);
        $object.css({"background-attachment" : "fixed"});
        
        $(window).scroll(function(){
          if($(window).width() > 768) {
            var firstTop = $object.offset().top,
                pos = $(window).scrollTop(),
                yPos = Math.round((multiplier * (firstTop - pos)) - 186);              

            var bg_css = 'center ' + yPos + 'px';

            $object.css({"background-position" : bg_css });
          } else {
            $object.css({"background-position" : "center" });
          }
        });
      };
      
      $(function(){
        // Hero Section - Background Parallax
        background_image_parallax($(".tm-parallax"), 0.30, false);
        background_image_parallax_2($("#contact"), 0.80);   
        background_image_parallax_2($("#testimonials"), 0.80);   
        
        // Handle window resize
        window.addEventListener('resize', function(){
          background_image_parallax($(".tm-parallax"), 0.30, true);
        }, true);

        // Detect window scroll and update navbar
        $(window).scroll(function(e){          
          if($(document).scrollTop() > 120) {
            $('.tm-navbar').addClass("scroll");
          } else {
            $('.tm-navbar').removeClass("scroll");
          }
        });
        
        // Close mobile menu after click 
        $('#tmNav a').on('click', function(){
          $('.navbar-collapse').removeClass('show'); 
        })

        // Scroll to corresponding section with animation
        $('#tmNav').singlePageNav({
          'easing': 'easeInOutExpo',
          'speed': 600
        });        
        
        // Add smooth scrolling to all links
        // https://www.w3schools.com/howto/howto_css_smooth_scroll.asp
        $("a").on('click', function(event) {
          if (this.hash !== "") {
            event.preventDefault();
            var hash = this.hash;

            $('html, body').animate({
              scrollTop: $(hash).offset().top
            }, 600, 'easeInOutExpo', function(){
              window.location.hash = hash;
            });
          } // End if
        });

        // Pop up
        $('.tm-gallery').magnificPopup({
          delegate: 'a',
          type: 'image',
          gallery: { enabled: true }
        });

        $('.tm-testimonials-carousel').slick({
          dots: true,
          prevArrow: false,
          nextArrow: false,
          infinite: false,
          slidesToShow: 3,
          slidesToScroll: 1,
          responsive: [
            {
              breakpoint: 992,
              settings: {
                slidesToShow: 2
              }
            },
            {
              breakpoint: 768,
              settings: {
                slidesToShow: 2
              }
            }, 
            {
              breakpoint: 480,
              settings: {
                  slidesToShow: 1
              }                 
            }
          ]
        });

        // Gallery
        $('.tm-gallery').slick({
          dots: true,
          infinite: false,
          slidesToShow: 5,
          slidesToScroll: 2,
          responsive: [
          {
            breakpoint: 1199,
            settings: {
              slidesToShow: 4,
              slidesToScroll: 2
            }
          },
          {
            breakpoint: 991,
            settings: {
              slidesToShow: 3,
              slidesToScroll: 2
            }
          },
          {
            breakpoint: 767,
            settings: {
              slidesToShow: 2,
              slidesToScroll: 1
            }
          },
          {
            breakpoint: 480,
            settings: {
              slidesToShow: 1,
              slidesToScroll: 1
            }
          }
        ]
        });
      });
    </script>
  </body>
</html>
